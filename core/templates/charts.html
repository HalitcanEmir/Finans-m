<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Hisse Sorgulama</title>
    <style>
        .data-cards { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 24px; }
        .card { background: #f8fafd; border: 1px solid #e0e0e0; border-radius: 6px; padding: 16px 18px; min-width: 120px; text-align: center; box-shadow: 0 1px 4px #0001; }
        .chart-container { margin-top: 32px; text-align: center; }
        .interval-select { margin-top: 12px; }
        .error-message { 
            background-color: #fff3f3; 
            border: 1px solid #ffcdd2; 
            color: #d32f2f; 
            padding: 12px 16px; 
            border-radius: 4px; 
            margin: 16px 0; 
        }
    </style>
</head>
<body>
    <h1>Hisse Sorgulama</h1>
    <form method="post">
        {% csrf_token %}
        <input type="text" name="symbol" placeholder="Ã–rn: NVDA, AAPL" required {% if symbol %}value="{{ symbol }}"{% endif %}>
        <select name="interval" class="interval-select">
            {% for code, label, period, interval in intervals %}
                <option value="{{ code }}" {% if code == selected_interval %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <button type="submit">Verileri GÃ¶ster</button>
    </form>

    {% if error %}
    <div class="error-message">
        {{ error }}
    </div>
    {% endif %}

    {% if chart_error %}
    <div class="error-message">
        {{ chart_error }}
    </div>
    {% endif %}

    {% if current_price %}
    <div class="data-cards">
        <div class="card"><b>SeÃ§ili AralÄ±k YÃ¼ksek</b><br>{% if range_high %}${{ range_high|floatformat:2 }}{% else %}Veri yok{% endif %}</div>
        <div class="card"><b>SeÃ§ili AralÄ±k DÃ¼ÅŸÃ¼k</b><br>{% if range_low %}${{ range_low|floatformat:2 }}{% else %}Veri yok{% endif %}</div>
        <div class="card"><b>SeÃ§ili AralÄ±k Ortalama</b><br>{% if range_mean %}${{ range_mean|floatformat:2 }}{% else %}Veri yok{% endif %}</div>
        <div class="card"><b>SeÃ§ili AralÄ±k Son Fiyat</b><br>{% if range_last %}${{ range_last|floatformat:2 }}{% else %}Veri yok{% endif %}</div>
        <div class="card"><b>Piyasa DeÄŸeri</b><br>{% if market_cap %}${{ market_cap }}{% else %}Veri yok{% endif %}</div>
        <div class="card"><b>52H YÃ¼ksek</b><br>{% if fifty_two_week_high %}${{ fifty_two_week_high }}{% else %}Veri yok{% endif %}</div>
        <div class="card"><b>52H DÃ¼ÅŸÃ¼k</b><br>{% if fifty_two_week_low %}${{ fifty_two_week_low }}{% else %}Veri yok{% endif %}</div>
        <div class="card"><b>Hedef Fiyat</b><br>{% if target_mean_price %}${{ target_mean_price }}{% else %}Veri yok{% endif %}</div>
    </div>
    <div class="card" style="margin-top:24px; max-width:400px; margin-left:auto; margin-right:auto;">
        <div class="card-header">
            <h5>ðŸ“Š Temel Finansal GÃ¶stergeler</h5>
        </div>
        <div class="card-body">
            <ul class="list-group" style="list-style:none; padding:0;">
                <li class="list-group-item"><strong>F/K (PE):</strong> {{ pe_ratio }}</li>
                <li class="list-group-item"><strong>PD/DD (PB):</strong> {{ pb_ratio }}</li>
                <li class="list-group-item"><strong>ROE:</strong> {{ roe }}</li>
                <li class="list-group-item"><strong>BorÃ§ / Ã–zsermaye:</strong> {{ de_ratio }}</li>
            </ul>
        </div>
    </div>
    {% endif %}
    {% if chart_image %}
    <div class="chart-container">
        <h3>{{ symbol }} - {{ selected_interval_label }}</h3>
        <img src="data:image/png;base64,{{ chart_image }}" alt="Fiyat GrafiÄŸi" style="max-width:100%; border:1px solid #eee; border-radius:6px;">
        {% if last_updated %}
        <p>Veriler gÃ¼ncellenme zamanÄ±: {{ last_updated }}</p>
        {% endif %}
    </div>
    {% endif %}
    {% if price_volume_chart or ma_chart or rsi_chart or macd_chart %}
    <div class="chart-container">
        <h2>Teknik Analiz Grafikler</h2>
        {% if price_volume_chart %}
        <div style="margin-bottom:24px;">
            <h4>Fiyat ve Hacim</h4>
            <img src="data:image/png;base64,{{ price_volume_chart }}" alt="Fiyat ve Hacim" style="max-width:100%; border:1px solid #eee; border-radius:6px;">
            <div style="font-size:13px; color:#555;">Fiyat (Ã§izgi) ve hacim (bar) aynÄ± grafikte gÃ¶sterilir.</div>
        </div>
        {% endif %}
        {% if ma_chart %}
        <div style="margin-bottom:24px;">
            <h4>Hareketli Ortalamalar (MA50 & MA200)</h4>
            <img src="data:image/png;base64,{{ ma_chart }}" alt="MA50 ve MA200" style="max-width:100%; border:1px solid #eee; border-radius:6px;">
            <div style="font-size:13px; color:#555;">Fiyat, 50 ve 200 gÃ¼nlÃ¼k hareketli ortalamalar ile birlikte gÃ¶sterilir.</div>
        </div>
        {% endif %}
        {% if rsi_chart %}
        <div style="margin-bottom:24px;">
            <h4>RSI (Relative Strength Index)</h4>
            <img src="data:image/png;base64,{{ rsi_chart }}" alt="RSI" style="max-width:100%; border:1px solid #eee; border-radius:6px;">
            <div style="font-size:13px; color:#555;">RSI son 14 gÃ¼nlÃ¼k fiyat ivmesini gÃ¶sterir. 70 Ã¼zeri aÅŸÄ±rÄ± alÄ±m, 30 altÄ± aÅŸÄ±rÄ± satÄ±m bÃ¶lgesidir.</div>
        </div>
        {% endif %}
        {% if macd_chart %}
        <div style="margin-bottom:24px;">
            <h4>MACD</h4>
            <img src="data:image/png;base64,{{ macd_chart }}" alt="MACD" style="max-width:100%; border:1px solid #eee; border-radius:6px;">
            <div style="font-size:13px; color:#555;">MACD ve sinyal Ã§izgisi ile trend deÄŸiÅŸimleri analiz edilir.</div>
        </div>
        {% endif %}
    </div>
    {% endif %}
</body>
</html> 